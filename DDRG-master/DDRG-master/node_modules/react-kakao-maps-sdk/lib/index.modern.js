import e,{useLayoutEffect as o,useEffect as t,useState as n,useRef as a,useImperativeHandle as r,useContext as i,useMemo as s}from"react";import l from"react-dom";function d(){return d=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},d.apply(this,arguments)}function c(e,o){if(null==e)return{};var t,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o.indexOf(t=r[n])>=0||(a[t]=e[t]);return a}const p="undefined"!=typeof window&&"undefined"!=typeof document?o:t,u=(e,o,t)=>{p(()=>{if(!e||!t)return;const n=(...o)=>void 0===o?t(e):t(e,...o);return kakao.maps.event.addListener(e,o,n),()=>{kakao.maps.event.removeListener(e,o,n)}},[e,o,t])};var k;!function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"}(k||(k={}));class m{constructor({appkey:e,id:o="__reactKakaoMapsSdkloaderId",libraries:t=[],nonce:n,retries:a=3,url:r="//dapi.kakao.com/v2/maps/sdk.js"}){if(this.id=void 0,this.appkey=void 0,this.url=void 0,this.libraries=void 0,this.nonce=void 0,this.retries=void 0,this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=void 0,this.id=o,this.appkey=e,this.libraries=t,this.nonce=n,this.retries=a,this.url=r,m.instance){if(!m.equalOptions(this.options,m.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(m.instance.options)}`);return m.instance}m.instance=this}get options(){return{appkey:this.appkey,id:this.id,libraries:this.libraries,nonce:this.nonce,retries:this.retries,url:this.url}}static isLoaded(){return new Promise(e=>m.instance?m.instance.status===k.FAILURE||m.instance.status===k.INITIALIZED?e(!1):(m.instance.status===k.LOADING&&m.loadcheckcallbacks.push(o=>e(!o)),e(!0)):window.kakao&&window.kakao.maps?window.kakao.maps.load(()=>{e(!0)}):m.loadcheckcallbacks.push(o=>{e(!o)}))}load(){return new Promise((e,o)=>{this.loadCallback(t=>{t?o(t.error):e(window.kakao)})})}get status(){return this.onerrorEvent?k.FAILURE:this.done?k.SUCCESS:this.loading?k.LOADING:k.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}loadCallback(e){this.callbacks.push(e),this.execute()}resetIfRetryingFailed(){this.failed&&this.reset()}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=void 0}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.kakao&&window.kakao.maps)return console.warn("Kakao Maps이 이미 외부 요소에 의해 로딩되어 있습니다.설정한 옵션과 일치 하지 않을 수 있으며, 이에 따른 예상치 동작이 발생할 수 있습니다."),void window.kakao.maps.load(this.callback);this.loading||(this.loading=!0,this.setScript())}}setScript(){document.getElementById(this.id)&&this.callback();const e=this.createUrl(),o=document.createElement("script");o.id=this.id,o.type="text/javascript",o.src=e,o.onerror=this.loadErrorCallback.bind(this),o.onload=this.callback.bind(this),o.defer=!0,o.async=!0,this.nonce&&(o.nonce=this.nonce),document.head.appendChild(o)}loadErrorCallback(e,o,t,n,a){if(this.errors.push({event:e,source:o,lineno:t,colno:n,error:a}),this.errors.length<=this.retries){const e=this.errors.length*2**this.errors.length;console.log(`Failed to load Kakao Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)}else this.onerrorEvent=this.errors[this.errors.length-1],this.callback()}createUrl(){let e=this.url;return e+=`?appkey=${this.appkey}`,this.libraries.length&&(e+=`&libraries=${this.libraries.join(",")}`),e+="&autoload=false",e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}callback(){kakao.maps.load(()=>{this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[],m.loadcheckcallbacks.forEach(e=>{e(this.onerrorEvent)}),m.loadcheckcallbacks=[]})}static equalOptions(e,o){if(e.appkey!==o.appkey)return!1;if(e.id!==o.id)return!1;if(e.libraries.length!==o.libraries.length)return!1;for(let t=0;t<e.libraries.length;++t)if(e.libraries[t]!==o.libraries[t])return!1;return e.nonce===o.nonce&&e.retries===o.retries&&e.url===o.url}}m.instance=void 0,m.loadcheckcallbacks=[];const g=["id","as","children","center","isPanto","padding","disableDoubleClick","disableDoubleClickZoom","draggable","zoomable","keyboardShortcuts","level","maxLevel","minLevel","mapTypeId","projectionId","scrollwheel","tileAnimation","onBoundsChanged","onCenterChanged","onClick","onDoubleClick","onDrag","onDragEnd","onDragStart","onIdle","onMaptypeidChanged","onMouseMove","onRightClick","onTileLoaded","onZoomChanged","onZoomStart","onCreate"],h=e.createContext(void 0),w=e.forwardRef((o,t)=>{let{id:i,as:s,children:l,center:k,isPanto:w=!1,padding:v=32,disableDoubleClick:f,disableDoubleClickZoom:C,draggable:y,zoomable:b,keyboardShortcuts:I,level:M,maxLevel:L,minLevel:O,mapTypeId:x,projectionId:S,scrollwheel:E,tileAnimation:z,onBoundsChanged:P,onCenterChanged:R,onClick:A,onDoubleClick:D,onDrag:T,onDragEnd:Z,onDragStart:W,onIdle:N,onMaptypeidChanged:j,onMouseMove:_,onRightClick:F,onTileLoaded:G,onZoomChanged:U,onZoomStart:V,onCreate:B}=o,$=c(o,g);const q=s||"div",[H,J]=n(!1),[K,X]=n(),Y=a(null);return p(()=>{m.isLoaded().then(J)},[]),p(()=>{if(!H)return;const e=Y.current;if(!e)return;const o="lat"in k?new kakao.maps.LatLng(k.lat,k.lng):new kakao.maps.Coords(k.x,k.y),t=new kakao.maps.Map(e,{center:o,disableDoubleClick:f,disableDoubleClickZoom:C,draggable:y,keyboardShortcuts:I,level:M,mapTypeId:x,projectionId:S,scrollwheel:E,tileAnimation:z});return X(t),()=>{e.innerHTML=""}},[H,f,C,x,z]),r(t,()=>K,[K]),p(()=>{K&&B&&B(K)},[K,B]),p(()=>{if(!K)return;let e=K.getCenter();e instanceof kakao.maps.Coords&&(e=e.toLatLng());const o="lat"in k?new kakao.maps.LatLng(k.lat,k.lng):new kakao.maps.Coords(k.x,k.y);o instanceof kakao.maps.LatLng&&o.equals(e)||o instanceof kakao.maps.Coords&&o.toLatLng().equals(e)||(w?K.panTo(o,v):K.setCenter(o))},[K,k.lat,k.lng,k.x,k.y]),p(()=>{K&&void 0!==y&&K.setDraggable(y)},[K,y]),p(()=>{K&&void 0!==b&&K.setZoomable(b)},[K,b]),p(()=>{K&&I&&"boolean"==typeof I&&K.setKeyboardShortcuts(I)},[K,I]),p(()=>{K&&M&&K.setLevel(M)},[K,M]),p(()=>{K&&x&&K.setMapTypeId(x)},[K,x]),p(()=>{K&&S&&K.setProjectionId(S)},[K,S]),p(()=>{K&&L&&K.setMaxLevel(L)},[K,L]),p(()=>{K&&O&&K.setMinLevel(O)},[K,O]),u(K,"bounds_changed",P),u(K,"center_changed",R),u(K,"click",A),u(K,"dblclick",D),u(K,"drag",T),u(K,"dragstart",W),u(K,"dragend",Z),u(K,"idle",N),u(K,"maptypeid_changed",j),u(K,"mousemove",_),u(K,"rightclick",F),u(K,"tilesloaded",G),u(K,"zoom_changed",U),u(K,"zoom_start",V),e.createElement(e.Fragment,null,e.createElement(q,d({id:i||"react-kakao-maps-sdk-map-container"},$,{ref:Y})),K&&e.createElement(h.Provider,{value:K},l))}),v=e=>{const o=i(h);if(!o)throw new Error((e?e+" Component":"useMap")+" must exist inside Map Component!");return o},f=e.forwardRef(({map:e,position:t,marker:n,children:i,altitude:d,disableAutoPan:c,range:p,removable:u,zIndex:k,onCreate:m},g)=>{const h=a(document.createElement("div")),w=s(()=>{const e=new kakao.maps.InfoWindow({altitude:d,disableAutoPan:c,range:p,removable:u,zIndex:k,content:h.current,position:t});return h.current.style.display="none",e},[c,u]);return r(g,()=>w,[w]),o(()=>(w.open(e,n),()=>{w.close()}),[e,n]),o(()=>{m&&m(w)},[w,m]),o(()=>{w&&w.setPosition(t)},[w,t]),o(()=>{w&&d&&w.setAltitude(d)},[w,d]),o(()=>{w&&p&&w.setRange(p)},[w,p]),o(()=>{w&&k&&w.setZIndex(k)},[w,k]),h.current.parentElement&&l.createPortal(i,h.current.parentElement)}),C=e.createContext(void 0),y=e.forwardRef(({children:t,averageCenter:n,calculator:a,clickable:i,disableClickZoom:l,gridSize:d,hoverable:c,minClusterSize:p,minLevel:k,styles:m,texts:g,onClusterclick:h,onClusterdblclick:w,onClustered:f,onClusterout:y,onClusterover:I,onClusterrightclick:M,onCreate:L},O)=>{const x=v("MarkerClusterer"),S=s(()=>{if(window.kakao.maps.MarkerClusterer)return new kakao.maps.MarkerClusterer({averageCenter:n,calculator:a,clickable:i,disableClickZoom:l,gridSize:d,hoverable:c,minClusterSize:p,minLevel:k,styles:m,texts:g});console.warn("clusterer 라이브러리를 별도 로드 해야 사용 가능합니다. `https://apis.map.kakao.com/web/guide/#loadlibrary`")},[]);return r(O,()=>S,[S]),o(()=>{null==S||S.setMap(x)},[x,S]),o(()=>{S&&L&&L(S)},[S,L]),o(()=>{S&&d&&(S.setGridSize(d),S.redraw())},[S,d]),o(()=>{S&&p&&(S.setMinClusterSize(p),S.redraw())},[S,p]),o(()=>{S&&void 0!==n&&(S.setAverageCenter(n),S.redraw())},[S,n]),o(()=>{S&&k&&(S.setMinLevel(k),S.redraw())},[S,k]),o(()=>{S&&g&&(S.setTexts(g),S.redraw())},[S,g]),o(()=>{S&&a&&(S.setCalculator(a),S.redraw())},[S,a]),u(S,"clustered",f),u(S,"clusterclick",h),u(S,"clusterover",I),u(S,"clusterout",y),u(S,"clusterdblclick",w),u(S,"clusterrightclick",M),o(()=>{S&&m&&(S.setStyles(m),S.redraw())},[S,m]),S?e.createElement(C.Provider,{value:S},t,e.createElement(b,{children:t})):null}),b=({})=>{const e=i(C);return p(()=>{e.redraw()}),null},I=e.forwardRef(({map:t,position:n,children:a,altitude:l,clickable:d,draggable:c,image:p,infoWindowOptions:k,onCreate:m,onClick:g,onDragEnd:h,onDragStart:w,onMouseOut:v,onMouseOver:y,opacity:b,range:I,title:M,zIndex:L},O)=>{const x=i(C),S=s(()=>new kakao.maps.Marker({altitude:l,clickable:d,draggable:c,image:p,opacity:b,range:I,title:M,zIndex:L,position:n}),[]);return r(O,()=>S,[S]),o(()=>(x?x.addMarker(S,!0):S.setMap(t),()=>{x?x.removeMarker(S,!0):S.setMap(null)}),[t,x,S]),o(()=>{m&&m(S)},[S,m]),u(S,"click",g),u(S,"dragstart",w),u(S,"dragend",h),u(S,"mouseout",v),u(S,"mouseover",y),o(()=>{t&&S&&n&&S.setPosition(n)},[t,S,n]),o(()=>{t&&S&&p&&S.setImage(p)},[t,S,p]),o(()=>{t&&S&&l&&S.setAltitude(l)},[t,S,l]),o(()=>{t&&S&&void 0!==d&&S.setClickable(d)},[t,S,d]),o(()=>{t&&S&&void 0!==c&&S.setDraggable(c)},[t,S,c]),o(()=>{t&&S&&b&&S.setOpacity(b)},[t,S,b]),o(()=>{t&&S&&I&&S.setRange(I)},[t,S,I]),o(()=>{t&&S&&M&&S.setTitle(M)},[t,S,M]),o(()=>{t&&S&&L&&S.setZIndex(L)},[t,S,L]),a?e.createElement(f,{position:n,map:t,marker:S,altitude:null==k?void 0:k.altitude,disableAutoPan:null==k?void 0:k.disableAutoPan,range:null==k?void 0:k.range,removable:null==k?void 0:k.removable,zIndex:null==k?void 0:k.zIndex},a):null}),M=e.forwardRef(({image:o,position:t,children:n,clickable:a,draggable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,title:g,zIndex:h},w)=>{const f=v("MapMarker"),C=s(()=>{var e,t,n,a,r,i,s,l,d,c,p,u;return o&&new kakao.maps.MarkerImage(o.src,new kakao.maps.Size(o.size.width,o.size.height),{alt:null==(e=o.options)?void 0:e.alt,coords:null==(t=o.options)?void 0:t.coords,offset:(null==(n=o.options)?void 0:n.offset)&&new kakao.maps.Point(null==(a=o.options)?void 0:a.offset.x,null==(r=o.options)?void 0:r.offset.y),shape:null==(i=o.options)?void 0:i.shape,spriteOrigin:(null==(s=o.options)?void 0:s.spriteOrigin)&&new kakao.maps.Point(null==(l=o.options)?void 0:l.spriteOrigin.x,null==(d=o.options)?void 0:d.spriteOrigin.y),spriteSize:(null==(c=o.options)?void 0:c.spriteSize)&&new kakao.maps.Size(null==(p=o.options)?void 0:p.spriteSize.width,null==(u=o.options)?void 0:u.spriteSize.height)})},[o]),y=s(()=>"lat"in t?new kakao.maps.LatLng(t.lat,t.lng):new kakao.maps.Coords(t.x,t.y).toLatLng(),[t.lat,t.lng,t.x,t.y]);return e.createElement(I,{map:f,position:y,image:C,clickable:a,draggable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,title:g,zIndex:h,ref:w},n)}),L=e.forwardRef(({position:o,children:t,disableAutoPan:n,removable:a,zIndex:r,onCreate:i},l)=>{const d=v("MapInfoWindow"),c=s(()=>new kakao.maps.LatLng(o.lat,o.lng),[o.lat,o.lng]);return e.createElement(f,{disableAutoPan:n,removable:a,zIndex:r,map:d,position:c,onCreate:i,ref:l},t)}),O=e.forwardRef(({position:e,children:t,clickable:n,xAnchor:d,yAnchor:c,zIndex:p,onCreate:u},k)=>{const m=i(C),g=v("CustomOverlayMap"),h=a(document.createElement("div")),w=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),f=s(()=>{const e=new kakao.maps.CustomOverlay({clickable:n,xAnchor:d,yAnchor:c,zIndex:p,position:w,content:h.current});return h.current.style.display="none",e},[n,d,c]);return r(k,()=>f,[f]),o(()=>{if(g)return m?m.addMarker(f,!0):f.setMap(g),()=>{m?m.removeMarker(f,!0):f.setMap(null)}},[g,m,f]),o(()=>{u&&u(f)},[f,u]),o(()=>{f.setPosition(w)},[f,w]),o(()=>{p&&f.setZIndex(p)},[f,p]),h.current.parentElement&&l.createPortal(t,h.current.parentElement)}),x=e.forwardRef(({position:e=kakao.maps.ControlPosition.TOPRIGHT},t)=>{const n=v("MapTypeControl"),a=s(()=>new kakao.maps.MapTypeControl,[]);return r(t,()=>a,[a]),o(()=>(n.addControl(a,e),()=>{n.removeControl(a)}),[n,a,e]),null}),S=e.forwardRef(({position:e=kakao.maps.ControlPosition.RIGHT},o)=>{const n=v("ZoomControl"),a=s(()=>new kakao.maps.ZoomControl,[]);return r(o,()=>a,[a]),t(()=>(n.addControl(a,e),()=>{n.removeControl(a)}),[n,e]),null}),E=({type:e})=>{const o=v("MapTypeId");return t(()=>(o.addOverlayMapTypeId(e),()=>{o.removeOverlayMapTypeId(e)}),[o,e]),null},z=e.forwardRef(({center:e,radius:t,fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:c,zIndex:p,onMouseover:k,onMouseout:m,onMousemove:g,onMousedown:h,onClick:w,onCreate:f},C)=>{const y=v("Circle"),b=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),I=s(()=>new kakao.maps.Circle({center:b,radius:t,fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:c,zIndex:p}),[]);return r(C,()=>I,[I]),o(()=>(I.setMap(y),()=>{I.setMap(null)}),[y,I]),o(()=>{f&&f(I)},[I,f]),o(()=>{I&&I.setPosition(b)},[I,b]),o(()=>{I.setRadius(t)},[I,t]),o(()=>{p&&I.setZIndex(p)},[I,p]),o(()=>{I.setOptions({fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:c})},[I,n,a,i,l,d,c]),u(I,"mouseover",k),u(I,"mouseout",m),u(I,"mousemove",g),u(I,"mousedown",h),u(I,"click",w),null}),P=e.forwardRef(({path:e,endArrow:t,onClick:n,onMousedown:a,onMousemove:i,onMouseout:l,onMouseover:d,onCreate:c,strokeColor:p,strokeOpacity:k,strokeStyle:m,strokeWeight:g,zIndex:h},w)=>{const f=v("Polyline"),C=s(()=>e.every(e=>e instanceof Array)?e.map(e=>e.map(e=>new kakao.maps.LatLng(e.lat,e.lng))):e.map(e=>new kakao.maps.LatLng(e.lat,e.lng)),[e]),y=s(()=>new kakao.maps.Polyline({path:C,endArrow:t,strokeColor:p,strokeOpacity:k,strokeStyle:m,strokeWeight:g,zIndex:h}),[]);return r(w,()=>y,[y]),o(()=>(y.setMap(f),()=>y.setMap(null)),[f,y]),o(()=>{c&&c(y)},[y,c]),o(()=>{y.setOptions({endArrow:t,strokeColor:p,strokeOpacity:k,strokeStyle:m,strokeWeight:g})},[y,t,p,k,m,g]),o(()=>{y.setPath(C)},[y,C]),o(()=>{h&&y.setZIndex(h)},[y,h]),u(y,"mouseover",d),u(y,"mouseout",l),u(y,"mousemove",i),u(y,"mousedown",a),u(y,"click",n),null}),R=e.forwardRef(({path:e,onClick:t,onMousedown:n,onMousemove:a,onMouseout:i,onMouseover:l,onCreate:d,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,fillColor:g,fillOpacity:h,zIndex:w},f)=>{const C=v("Polygon"),y=s(()=>e.every(e=>e instanceof Array)?e.map(e=>e.map(e=>new kakao.maps.LatLng(e.lat,e.lng))):e.map(e=>new kakao.maps.LatLng(e.lat,e.lng)),[e]),b=s(()=>new kakao.maps.Polygon({path:y,fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,zIndex:w}),[]);return r(f,()=>b,[b]),o(()=>(b.setMap(C),()=>b.setMap(null)),[C,b]),o(()=>{d&&d(b)},[b,d]),o(()=>{b.setOptions({fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m})},[b,g,h,c,p,k,m]),o(()=>{b.setPath(y)},[b,y]),o(()=>{w&&b.setZIndex(w)},[b,w]),u(b,"mouseover",l),u(b,"mouseout",i),u(b,"mousemove",a),u(b,"mousedown",n),u(b,"click",t),null}),A=e.forwardRef(({bounds:e,onClick:t,onMousedown:n,onMousemove:a,onMouseout:i,onMouseover:l,onCreate:d,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,fillColor:g,fillOpacity:h,zIndex:w},f)=>{const C=v("Rectangle"),y=s(()=>new kakao.maps.LatLngBounds(new kakao.maps.LatLng(e.sw.lat,e.sw.lng),new kakao.maps.LatLng(e.ne.lat,e.ne.lng)),[e]),b=s(()=>new kakao.maps.Rectangle({bounds:y,fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,zIndex:w}),[]);return r(f,()=>b,[b]),o(()=>(b.setMap(C),()=>b.setMap(null)),[C,b]),o(()=>{d&&d(b)},[b,d]),o(()=>{b.setOptions({fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m})},[b,g,h,c,p,k,m]),o(()=>{b.setBounds(y)},[b,y]),o(()=>{w&&b.setZIndex(w)},[b,w]),u(b,"mouseover",l),u(b,"mouseout",i),u(b,"mousemove",a),u(b,"mousedown",n),u(b,"click",t),null}),D=e.forwardRef(({center:e,rx:t,ry:n,fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:c,strokeWeight:p,zIndex:k,onMouseover:m,onMouseout:g,onMousemove:h,onMousedown:w,onClick:f,onCreate:C},y)=>{const b=v("Ellipse"),I=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),M=s(()=>new kakao.maps.Ellipse({center:I,rx:t,ry:n,fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:c,strokeWeight:p,zIndex:k}),[]);return r(y,()=>M,[M]),o(()=>(M.setMap(b),()=>{M.setMap(null)}),[b,M]),o(()=>{C&&C(M)},[M,C]),o(()=>{M&&M.setPosition(I)},[M,I]),o(()=>{M.setRadius(t,n)},[M,t,n]),o(()=>{k&&M.setZIndex(k)},[M,k]),o(()=>{M.setOptions({fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:c,strokeWeight:p})},[M,a,i,l,d,c,p]),u(M,"mouseover",m),u(M,"mouseout",g),u(M,"mousemove",h),u(M,"mousedown",w),u(M,"click",f),null}),T=e.forwardRef(({draw:e,onAdd:t,onRemove:n,onCreate:a},i)=>{const l=v(),d=s(()=>{class o extends kakao.maps.AbstractOverlay{constructor(e,o,t){super(),this.draw=e,this.onAdd=o,this.onRemove=t}}return new o(e,t,n)},[e,t,n]);return r(i,()=>d,[d]),o(()=>(d.setMap(l),()=>{d.setMap(null)}),[l,d]),o(()=>{a&&a(d)},[d,a]),null}),Z=["id","as","children","position","pan","panoId","panoX","panoY","tilt","zoom","onCreate","onInit","onPanoidChange","onPositionChanged","onViewpointChange","onErrorGetNearestPanoId"],W=e.createContext(void 0),N=e.forwardRef((o,t)=>{let{id:i,as:s,children:l,position:k,pan:g,panoId:h,panoX:w,panoY:v,tilt:f,zoom:C,onCreate:y,onInit:b,onPanoidChange:I,onPositionChanged:M,onViewpointChange:L,onErrorGetNearestPanoId:O}=o,x=c(o,Z);const S=s||"div",[E,z]=n(!1),[P,R]=n(!0),[A,D]=n(),T=a(null);return p(()=>{m.isLoaded().then(z)},[]),p(()=>{if(!E)return;const e=T.current;if(!e)return;const o=new kakao.maps.Roadview(e,{pan:g,panoId:h,panoX:w,panoY:v,tilt:f,zoom:C});return D(o),()=>{e.innerHTML=""}},[E,w,v,C]),r(t,()=>A,[A]),p(()=>{A&&y&&y(A)},[A,y]),p(()=>{if(!A||h||A.getPosition().getLat()===k.lat&&A.getPosition().getLng()===k.lng)return;const e=new kakao.maps.LatLng(k.lat,k.lng);(new kakao.maps.RoadviewClient).getNearestPanoId(e,k.radius,o=>{null===o&&O?O(A):A.setPanoId(o,e)})},[A,h,k.lat,k.lng,k.radius,O]),p(()=>{if(!A||!h||h===A.getPanoId()||A.getPosition().getLat()===k.lat&&A.getPosition().getLng()===k.lng)return;const e=new kakao.maps.LatLng(k.lat,k.lng);A.setPanoId(h,e)},[A,h,k.lat,k.lng]),p(()=>{if(!A)return;const e=A.getViewpoint();e.pan===g&&e.tilt===f||(g&&(e.pan=g),f&&(e.tilt=f),A.setViewpoint(e))},[A,g,f]),u(A,"init",e=>{R(!1),b&&b(e)}),u(A,"panoid_changed",I),u(A,"viewpoint_changed",L),u(A,"position_changed",M),e.createElement(e.Fragment,null,e.createElement(S,d({ref:T,id:i||"react-kakao-maps-sdk-roadview-container"},x)),A&&!P&&e.createElement(W.Provider,{value:A},l))}),j=e=>{const o=i(W);if(!o)throw new Error((e?e+" Component":"useRoadview")+" must exist inside Roadview Component!");return o},_=e.forwardRef(({position:e,children:t,clickable:n,xAnchor:i,yAnchor:d,zIndex:c,altitude:p,range:u,onCreate:k},m)=>{const g=j("CustomOverlayRoadview"),h=a(document.createElement("div")),w=s(()=>"lat"in e?new kakao.maps.LatLng(e.lat,e.lng):new kakao.maps.Viewpoint(e.pan,e.tilt,e.zoom,e.panoId),[e.lat,e.lng,e.pan,e.tilt,e.zoom,e.panoId]),v=s(()=>{const e=new kakao.maps.CustomOverlay({clickable:n,xAnchor:i,yAnchor:d,zIndex:c,position:w,content:h.current});return h.current.style.display="none",e},[n,i,d]);return r(m,()=>v,[v]),o(()=>{if(g)return v.setMap(g),()=>{v.setMap(null)}},[v,g]),o(()=>{k&&k(v)},[v,k]),o(()=>{v.setPosition(w)},[v,w]),o(()=>{c&&v.setZIndex(c)},[v,c]),o(()=>{p&&v.setAltitude(p)},[v,p]),o(()=>{u&&v.setRange(u)},[v,u]),h.current.parentElement&&l.createPortal(t,h.current.parentElement)}),F=e.forwardRef(({image:o,position:t,children:n,altitude:a,clickable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,range:g,title:h,zIndex:w},v)=>{const f=j("RoadviewMarker"),C=s(()=>{var e,t,n,a,r,i,s,l,d,c,p,u;return o&&new kakao.maps.MarkerImage(o.src,new kakao.maps.Size(o.size.width,o.size.height),{alt:null==(e=o.options)?void 0:e.alt,coords:null==(t=o.options)?void 0:t.coords,offset:(null==(n=o.options)?void 0:n.offset)&&new kakao.maps.Point(null==(a=o.options)?void 0:a.offset.x,null==(r=o.options)?void 0:r.offset.y),shape:null==(i=o.options)?void 0:i.shape,spriteOrigin:(null==(s=o.options)?void 0:s.spriteOrigin)&&new kakao.maps.Point(null==(l=o.options)?void 0:l.spriteOrigin.x,null==(d=o.options)?void 0:d.spriteOrigin.y),spriteSize:(null==(c=o.options)?void 0:c.spriteSize)&&new kakao.maps.Size(null==(p=o.options)?void 0:p.spriteSize.width,null==(u=o.options)?void 0:u.spriteSize.height)})},[o]),y=s(()=>"lat"in t?new kakao.maps.LatLng(t.lat,t.lng):"x"in t?new kakao.maps.Coords(t.x,t.y).toLatLng():new kakao.maps.Viewpoint(t.pan,t.tilt,t.zoom,t.panoId),[t.lat,t.lng,t.x,t.y,t.pan,t.tilt,t.zoom,null==t?void 0:t.panoId]);return e.createElement(I,{map:f,position:y,image:C,altitude:a,clickable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,range:g,title:h,zIndex:w,ref:v},n)}),G=e.forwardRef(({position:o,children:t,altitude:n,disableAutoPan:a,range:r,removable:i,zIndex:l,onCreate:d},c)=>{const p=j("RoadviewInfoWindow"),u=s(()=>"lat"in o?new kakao.maps.LatLng(o.lat,o.lng):new kakao.maps.Viewpoint(o.pan,o.tilt,o.zoom,o.panoId),[o.lat,o.lng,o.pan,o.tilt,o.zoom,o.panoId]);return e.createElement(f,{altitude:n,disableAutoPan:a,range:r,removable:i,zIndex:l,map:p,position:u,onCreate:d,ref:c},t)}),U=e.createContext(void 0);function V(e,t,n){o(()=>{e&&n&&e.addListener(t,(...o)=>void 0===o?n(e):n(e,...o))},[n,e,t])}const B=e.forwardRef(function({arrowOptions:t,circleOptions:n,ellipseOptions:a,markerOptions:i,polygonOptions:l,polylineOptions:d,rectangleOptions:c,drawingMode:p,guideTooltip:u,onSelect:k,onDrawstart:m,onDraw:g,onDrawend:h,onDrawnext:w,onCancle:f,onRemove:C,onStateChanged:y,onCreate:b,children:I},M){const L=v("Toolbox"),O=s(()=>{if(window.kakao.maps.drawing)return new kakao.maps.drawing.DrawingManager({map:L,drawingMode:p,guideTooltip:u,arrowOptions:t,circleOptions:n,ellipseOptions:a,markerOptions:i,polygonOptions:l,polylineOptions:d,rectangleOptions:c});console.warn("drawing 라이브러리를 별도 로드 해야 사용 가능합니다. `https://apis.map.kakao.com/web/guide/#loadlibrary`")},[]);return r(M,()=>O,[O]),o(()=>{O&&b&&b(O)},[O,b]),V(O,"select",k),V(O,"drawstart",m),V(O,"draw",g),V(O,"drawend",h),V(O,"drawnext",w),V(O,"cancel",f),V(O,"remove",C),V(O,"state_changed",y),O?e.createElement(U.Provider,{value:O},I):null}),$=e.forwardRef(function({position:e},t){e=e||kakao.maps.ControlPosition.TOP;const n=v("Toolbox"),a=i(U);if(!a)throw new Error("Toolbox must exist inside DrawingManager Component!`");const l=s(()=>new kakao.maps.drawing.Toolbox({drawingManager:a}),[a]);return r(t,()=>l,[l]),o(()=>{const o=l.getElement();return n.addControl(o,e),()=>{n.removeControl(o)}},[n,l,e]),null}),q=e.forwardRef(({id:o="react-kakao-maps-sdk-staticmap-container",style:t,className:i,center:s,marker:l,level:c,mapTypeId:u,onCreate:k},m)=>{const[g,h]=n(),w=a(null);return p(()=>{if(!window.kakao)return void console.warn("kakao map javascript api를 먼저 불러와야 합니다. `https://apis.map.kakao.com/web/guide`");const e=w.current;e&&kakao.maps.load(()=>{const o=Array.isArray(l)?l.map(e=>d({},e,{position:new kakao.maps.LatLng(e.position.lat,e.position.lng)})):"object"==typeof l&&l.position?d({},l,{position:new kakao.maps.LatLng(l.position.lat,l.position.lng)}):l,t=new kakao.maps.StaticMap(e,{center:new kakao.maps.LatLng(s.lat,s.lng),level:c,mapTypeId:u,marker:o});h(t)})},[JSON.stringify(l)]),r(m,()=>g,[g]),p(()=>{g&&g.setCenter(new kakao.maps.LatLng(s.lat,s.lng))},[g,s.lat,s.lng]),p(()=>{g&&c&&g.setLevel(c)},[g,c]),p(()=>{g&&u&&g.setMapTypeId(u)},[g,u]),p(()=>{g&&k&&k(g)},[g,k]),e.createElement("div",{id:o,style:t,className:i,ref:w})}),H=e=>{const[o,a]=n({loading:!0,error:void 0}),r=s(()=>new m(e),[JSON.stringify(e)]);return t(()=>{r.load().then(()=>a({loading:!1,error:void 0})).catch(e=>a({loading:!1,error:e}))},[r]),o};export{T as AbstractOverlay,z as Circle,O as CustomOverlayMap,_ as CustomOverlayRoadview,B as DrawingManager,D as Ellipse,m as Loader,w as Map,L as MapInfoWindow,M as MapMarker,x as MapTypeControl,E as MapTypeId,y as MarkerClusterer,R as Polygon,P as Polyline,A as Rectangle,N as Roadview,G as RoadviewInfoWindow,F as RoadviewMarker,q as StaticMap,$ as Toolbox,S as ZoomControl,H as useInjectKakaoMapApi,v as useMap,j as useRoadview};
//# sourceMappingURL=index.modern.js.map
